# **火车票系统开发文档**

## **模块划分图**

## **信息存储模块**

用于将各种信息保存至外存的模块。

用于保存信息的文件结构有两种，一种是基于B+树的索引结构，另一种是比较朴素的有序列表。

### **b+树**

用于快速检索符合条件的信息，key值与value值一一对应。

支持的操作有：

 - **单点插入**：将一对key值和value值插入b+树中；如果这个key值已经存在，那么就将原value值替换为新value值。

 - **单点查询**：查询指定的key值对应的value值，如果不存在这个key值，则返回0。

 - **区间查询**：查询指定的key值区间的value值，记录在一个数组中。

 - **清空**。

相关类：node, btree.

### **列表**

顺序存储信息，本身一般不具备索引。配合b+树使用，通过b+树索引在列表中的位置，实现存储大块的数据。

支持的操作有：

 - **尾端插入**：将任意类型的数据插入至尾端，返回索引。

 - **取值**：通过索引，在指定位置获取任意类型的数据。

 - **修改**：通过索引，在指定位置写入覆盖任意类型的数据。

 - **清空**。

相关类：mylist.


## **命令输入模块**

包含多个系统。

 - 对于输入的命令字符串，分解成可供程序识别的解释系统。

 - 将输入的日期或时间转化成以分钟为单位的整型，或者将整型输出成日期+时间的格式的时间系统。

 - 计算字符串的哈希值的哈希系统。

### **解释系统**

对于输入的命令字符串，分解成可供程序识别。

相关类：explainer.

### **时间系统**

将输入的日期或时间转化成以分钟为单位的整型，或者将整型输出成日期+时间的格式。

相关函数：<a href='#date2day'>date2day</a>, <a href='#date2minute'>date2minute</a>, <a href='#printTime'>printTime</a>.

### **哈希系统**

计算字符串的哈希值。

采用双哈希算法。

相关函数：<a href='#myHash'>myHash</a>.


## **用户管理模块**

## **列车管理模块**

## **订单管理模块**

## **类和函数**

### **约定**


```
typedef unsigned long word;
typedef unsigned long long dword;
```


### **类**
### **函数**
#### <a name='date2day'>**date2day**</a>

```
word date2day(const char* s);
```

将形如"xx-xx"的字符串日期，转化为无符号长整型的天数。

具体数值为1月1日到这个日期所经过的天数乘。


#### <a name='date2minute'>**date2minute**</a>

```
word date2minute(const char* s);
```

将形如"xx-xx"的字符串日期，转化为无符号长整型的分钟数。

具体数值为1月1日到这个日期所经过的天数乘以每天的分钟数。

#### <a name='printTime'>**printTime**</a>

```
void printTime(word x);
```

将无符号长整型的分钟数，输出为"xx-xx xx:xx"格式的日期+时间。

#### <a name='myHash'>**myHash**</a>

```
word myHash(const char *str);
```

通过简单的哈希算法，计算字符串的无符号长整型哈希值。

为了防止冲突，在计算时将长整型划分为两个短整型分别同时计算。

最后将两个短整型再合并成长整型。
